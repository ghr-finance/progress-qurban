<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8" />
<title>Progress Pembayaran</title>
<style>
  body { font-family: sans-serif; margin: 20px; }
  table { border-collapse: collapse; width: 100%; margin-top: 20px; }
  th, td { border: 1px solid #ddd; padding: 8px; text-align: left; }
  th { background: #f0f0f0; }
  .progress-bar {
    background: #eee;
    border-radius: 4px;
    overflow: hidden;
    height: 20px;
    margin: 5px 0;
  }
  .progress-bar-fill {
    background: #4caf50;
    height: 100%;
    width: 0%;
    transition: width 0.3s;
  }
</style>
</head>
<body>

<h2>Progress Pembayaran Iuran</h2>
<table id="table">
  <thead>
    <tr>
      <th>No</th>
      <th>Nama</th>
      <th>Alamat</th>
      <th>Jumlah Iuran</th>
      <th>Jenis Hewan</th>
      <th>Total Iuran</th>
      <th>Persentase</th>
      <th>Progress</th>
    </tr>
  </thead>
  <tbody></tbody>
</table>

<script>
  const apiUrl = 'https://script.google.com/macros/s/AKfycby1ejHKB5Mf959U0ztMjqaiG7Xqat1-vy5TUPwA_ghUiVe1rHejIA4Ujs5u4hXkEzerLg/exec';

  fetch(apiUrl)
    .then(res => res.json())
    .then(data => {
      const tbody = document.querySelector('#table tbody');
      data.forEach((item, idx) => {
        const jumlah = parseInt(item['Total Iuran'].replace(/[^0-9]/g, ''), 10) || 0;
        const persentase = Math.min(100, (jumlah / 4500000) * 100).toFixed(0);

        const tr = document.createElement('tr');
        tr.innerHTML = `
          <td>${idx + 1}</td>
          <td>${item['Nama']}</td>
          <td>${item['Alamat']}</td>
          <td>${item['Jumlah Iuran']}</td>
          <td>${item['Jenis Hewan']}</td>
          <td>${item['Total Iuran']}</td>
          <td>${persentase}%</td>
          <td>
            <div class="progress-bar">
              <div class="progress-bar-fill" style="width: ${persentase}%"></div>
            </div>
          </td>
        `;
        tbody.appendChild(tr);
      });
    });
</script>

</body>
</html>
